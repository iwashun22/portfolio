---
import { orderFormats } from '@utils/helpers';

interface Props {
  images: ImageMetadata[],
  altText?: string,
  order?: Array<ImageMetadata["format"]>
}
const {
  images,
  altText = 'Image',
  order = ['avif', 'webp', 'jpeg']
}: Props = Astro.props;

if (order.length < 1) {
  throw new Error('Empty order');
}

const rearranged = orderFormats(images, order);
if (rearranged.length < 1) {
  console.warn(`No image found in the formats: ${order.join(', ')}`);
}
---

{
  rearranged.map(image => (
    <source srcset={image.src} type={`image/${image.format}`}/>
  ))
}
<img src={images[images.length-1].src} alt={altText}/>